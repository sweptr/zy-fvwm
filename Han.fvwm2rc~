#####
# .fvwm2rc
# Christopher Han (xiphux@planetjurai.com)
#
# Adapted from an original .fvwm2rc
# by Tavis Ormandy (taviso@gentoo.org)
# 
# Comments/scripts/modifications are attributed
# to their appropriate authors.
#
# Last Modified: March 20, 2004
#########################################

#####
# Set the directories to look in for Image files.
#
# - taviso
#################
#ImagePath ${HOME}/icons:/usr/share/icons:+
#ImagePath /usr/share/icons/gentoo/32x32:+
ImagePath ${HOME}/icons:/storage/icons:/usr/share/icons:+

#####
# You can set simple options like this, using variables.
#
# If you need something more complex, read the man pages for FvwmCPP, FvwmM4 or FvwmPerl.
#
# -taviso
#################
SetEnv fvwm_video_path $[HOME]/media/video
SetEnv fvwm_video_exec mplayer

SetEnv fvwm_audio_path $[HOME]/media/audio
SetEnv fvwm_audio_exec beep-media-player --play

SetEnv fvwm_image_path $[HOME]/media/images
SetEnv fvwm_image_exec xv

SetEnv fvwm_rom_path $[HOME]/stuff/zsnes
SetEnv fvwm_rom_exec zsnes

SetEnv fvwm_wallpaper $[HOME]/.wallpaper.png

#####
# If you use Thumbnails, how big would you like the Icons to be?
#
# Try one of these, from tiny to large: 32, 64, 96, 128
#
# Note that the aspect ratio is maintained, so tall and thin windows may get larger icons,
# but you can change that if it annoys you.
# 
# -taviso
#################
SetEnv fvwm_icon_size 96

#####
# You can automatically move the viewport into adjacent pages when the pointer
# hits the screen edge, but I dont like this.
# This EdgeResistance disables it, but still allows me to move windows over onto adjacent pages.
#
# EdgeThickness disables edge scrolling and EdgeCommand, which I never use.
# 
# -taviso
#################
EdgeResistance 1000 20
EdgeThickness 0

#####
# You will want to disable this if you are running fvwm over a network, but otherwise this
# handy setting stops NumLock/ScrollLock from interfering with bindings.
#
# If you disable this, I guarantee it will catch you out and have you scratching your
# head at some point :)
#
# [3]http://www.fvwm.org/documentation/faq/#5.5
#
# -taviso
#################
IgnoreModifiers L25

#####
# You can use EwmhBaseStruts to stop Maximised windows from obscuring TaskBars/ButtonBars
# or anything else you always want to be visible.
#
# This Setting makes sure my ButtonBar on the left and taskbar along the bottom is always
# visible.
#
# -taviso
#################
EwmhBaseStruts 70 128 0 20

######
# Fvwm uses a default ClickTime of 150ms, which is way too short for me.
# A Click that lasts <= ClickTime is considered a `Click` in functions,
# > ClickTime is a `Hold`.
#
# -taviso
#################
ClickTime 550

#####
# Use 9 pages per desktop, arranged in a square, like this:
#
#   +-----+-----+-----+
#   |     |     |     |
#   +-----+-----+-----+
#   |     |     |     |
#   +-----+-----+-----+
#   |     |     |     |
#   +-----+-----+-----+
#
# -taviso
#################
DeskTopSize 3x3

######
# Use an arrow rather than the `X` cursor on the root window.
#
# -taviso
#################
CursorStyle root top_left_arrow

#####
# OpaqueMoveSize allows you to stop Large windows from being moved opaquely,
# I like the effect, and have Cycles to burn, so all windows can use it.
#
# SnapAttraction lets nearby windows snap together, or snap to edges so that they
# are easier to align on your desktop, The default is off, if you set it too large
# it's annoying as hell, 3 pixels is just right.
#
# -taviso
#################
OpaqueMoveSize -1
SnapAttraction 3

######
# Ksh has my favourite shell syntax, so use it if it exists.
#
# -taviso
#################
#Test (f /bin/ksh) ExecUseShell /bin/ksh

######
# Menu Settings.
#
#   * PopupOffset allows you to control where submenus will appear, and
#       whether they should overlap or not.
#   * This menu uses a translucent Colorset, and Hilighted items are light
#       blue with a single pixel border.
#   * The Menu will look flat, with a 2 pixel border.
#   * I changed the default ItemFormat to be a little more spacious.
#
# AutomaticHotKeys generates your HotKeys (Keys you can press when a menu opens to
# jump straight to an item) for you, you can write your own also, or disable them.
# I've gone off HotKeys recently, so it's disabled for now.
#
# -taviso (commented out)
# -xiphux (translucent black menu)
#################
#Colorset 0 fg black, bg grey, sh black, hi black, Translucent #c6cfce 90
Colorset 0 fg white, hi white, DGradient 128 1 #f6f6f6 50 #101010, Translucent black 70
Colorset 1 fg black, bg #9cb2ce, hi #dcdcdc, sh #dcdcdc

MenuStyle * Hilight3DThin, PopupOffset -6 100
MenuStyle * Font "Shadow=1 1 SE:xft:snap"
MenuStyle * MenuColorset 0, HilightBack, ActiveColorset 1
MenuStyle * BorderWidth 2, TitleUnderlines1, SeparatorsLong, TrianglesSolid, Animation
MenuStyle * ItemFormat "%.2|%.5i%.5l%.5i%2.3>%2|"
# MenuStyle * AutomaticHotKeys

#Colorset 7 fg white, hi white, DGradient 128 1 #f6f6f6 50 #101010, Translucent black 50
#MenuStyle * FVWM, PopupOffset -6 100, Animation Off
#MenuStyle * Font "xft:snap", MenuColorset 7, HilightBack grey
#MenuStyle * Greyed black, Hilight3DOff, BorderWidth 1, TitleUnderLines1
#MenuStyle * SeparatorsLong, TrianglesSolid, Animation
#MenuStyle * ItemFormat "%.4s%.1|%.5i%.51%.51%.5r%.5i%.20p%2.3>%1|"


######
# Use colormaps according to Focus, rather than where the Mouse is.
#
# -taviso
#################
ColormapFocus FollowsFocus

######
# Default window Styles.
#
# I like single pixel borders, which look cleaner and simpler that the default 3d borders.
#
# It can be a little tricky to grab the handles, but I usually use a Key Binding for that
# anyway, you can always make the handles stick out a bit more if you use them more than I do.
#
# SloppyFocus is the one true Focus policy :) (focus follows mouse, except on root)
#
# If I click in a window, I like it to be raised.
#
# GrabFocus is terrible, windows are always stealing focus and keystrokes end up in the wrong
# windows and you lose your train of thought, etc. So turn it off here, and back on for windows
# that play nice with it.
#
# Set up an IconBox (an area that Windows jump to by default when Iconified) in the bottom left
#
# Syntax Reminder:
#
# IconBox [screen scr-spec] l t r b
#
# Fvwm offers several placement policies, which decide where new windows should appear, I've
# found that SmartPlacement makes a decent guess at where the windows should be, but there are
# plenty more to choose from.
#
# -taviso
#################
#Style * Font "xft:Bitstream Vera Sans Mono:style=Roman:size=11"
Style * Font "xft:Aquafont:size=11", BorderWidth 1, HandleWidth 1
Style * Color #f6f6f6/black, HilightBack black, HilightFore white
Style * MWMFunctions, MWMDecor, HintOverride, DecorateTransient, NoPPosition
Style * IconBox 20 100 100 -15, SloppyFocus, MouseFocusClickRaises
Style * SmartPlacement, WindowShadeSteps 20, ResizeOpaque
Style * Button 1, Button 2, Button 4, Button 6, GrabFocusOff
Style * NoIconTitle

# Comment out these lines if you don't like Icons to have Titles.
Colorset 11 fg black, bg white, NoShape, RootTransparent Buffer
Style * IconTitle, IconTitleColorset 11, HilightIconTitleColorset 11, IconTitleRelief 0
Style * IconFont "xft:Aquafont:size=11", IndexedIconName

# This is another nice Placement Policy, which tries to avoid obscuring existing windows,
# you can set penalties on certain window types so some are less likely to be obscured than
# others. Check the manpage for even more Placement Policies.
#Style * MinOverlapPercentPlacement
#Style * MinOverlapPercentPlacementPenalties 2 5 1 2 0.5 50

BorderStyle Active Solid black -- NoInset HiddenHandles
BorderStyle Inactive Solid black -- NoInset HiddenHandles

#####
# My Vectors look like this
#
# +----------------------------------------------------------+
# | .                                                _  #  X |
# +----------------------------------------------------------+
# | 1                                                6  4  2 |
# |                                                          |
#                                                            |
#
# When the Buttons are ActiveDown (Pressed), they move 5% to the right
# and 5% down, which gives the impression of being pressed. I've also used
# a vector to seperate the buttons out on active windows.
#
# Active Window TitleBar has a Vertical Gradient of White (at the top) to
# Black at the bottom where the buttons are, and a gradient of Blue to black over
# the title, using 16 shades (one for each pixel, so looks like a nice, smooth transition).
#
# Inactive uses a tinted transparent colorset, with white text and buttons.
#
# -taviso (original vector version, commented)
# -xiphux (pixmap buttons / decor)
##################
Colorset 7 fg black, bg white, NoShape, RootTransparent Buffer, Tint #5a8ade 60
Colorset 8 fg black, bg white, NoShape, RootTransparent Buffer, Tint #f6f6f6 20

DestroyDecor DefaultDecor
AddToDecor DefaultDecor
+ TitleStyle LeftJustified Height 22
+ TitleStyle InActive ( Colorset 8 -- Flat ) \
    Active ( VGradient 16 1 #5a8ade 50 #000000 -- Flat )
#+ TitleStyle Active MultiPixmap Main TiledPixmap title_active.xpm, \
#				RightEnd AdjustedPixmap titleright_active.xpm
+ ButtonStyle All InActive ( Colorset 8 -- Flat )
+ ButtonStyle All Active ( VGradient 15 1 #f6f6f6 90 #000000 -- Flat )

#+ AddButtonStyle  4 ActiveUp Vector 9 30x30@2 30x60@2 60x60@2 60x30@2 \
#        30x30@2 30x35@2 60x35@2 0x99@4 0x0@2 -- Flat
#+ AddButtonStyle  4 Inactive Vector 7 30x30@3 30x60@3 60x60@3 60x30@3 \
#        30x30@3 30x35@3 60x35@3 -- Flat
#+ AddButtonStyle  4 ActiveDown Vector 10 35x35@2 35x65@2 65x65@2 65x35@2 \
#        35x35@2 35x40@2 65x40@2 0x99@4 0x0@2 99x0@2 -- Flat
+ AddButtonStyle 4 ActiveUp pixmap buttons/greenglass_max.xpm
+ AddButtonStyle 4 Inactive pixmap buttons/grayglass_max.xpm
+ AddButtonStyle 4 ActiveDown pixmap buttons/greenglass_max_pressed.xpm
	
#+ AddButtonStyle  1 Inactive Vector 4 44x44@3 44x45@3 45x45@3 44x44@3 -- Flat
#+ AddButtonStyle  1 ActiveUp Vector 6 44x44@2 44x45@2 45x45@2 44x44@2 99x99@4 \
#        99x0@2 -- Flat
#+ AddButtonStyle  1 ActiveDown Vector 8 49x49@2 49x50@2 50x50@2 49x49@2 99x90@4 \
#        99x0@2 99x0@2 0x0@2-- Flat
+ AddButtonStyle 1 ActiveUp pixmap buttons/blueglass_menu.xpm
+ AddButtonStyle 1 Inactive pixmap buttons/grayglass_menu.xpm
+ AddButtonStyle 1 ActiveDown pixmap buttons/blueglass_menu_pressed.xpm

#+ AddButtonStyle  6 ActiveUp Vector 7 30x60@2 60x60@2 60x50@2 30x50@2 30x60@2 0x99@4 \
#        0x0@2 -- Flat
#+ AddButtonStyle  6 Inactive Vector 5 30x60@3 60x60@3 60x50@3 30x50@3 30x60@3 -- Flat
#+ AddButtonStyle  6 ActiveDown Vector 8 35x65@2 65x65@2 65x60@2 35x60@2 35x65@2 0x99@4 \
#        0x0@2 99x0@2 -- Flat
+ AddButtonStyle 6 ActiveUp pixmap buttons/yellowglass_min.xpm
+ AddButtonStyle 6 Inactive pixmap buttons/grayglass_min.xpm
+ AddButtonStyle 6 ActiveDown pixmap buttons/yellowglass_min_pressed.xpm
	
#+ AddButtonStyle  2 ActiveUp Vector 6 30x30@2 60x60@2 60x30@4 30x60@2 0x99@4 \
#        0x0@2 -- Flat
#+ AddButtonStyle  2 Inactive Vector 4 30x30@3 60x60@3 60x30@4 30x60@3 -- Flat
#+ AddButtonStyle  2 ActiveDown Vector 7 35x35@2 65x65@2 65x35@4 35x65@2 0x99@4 \
#        0x0@2 99x0@2 -- Flat
+ AddButtonStyle 2 ActiveUp pixmap buttons/redglass_close.xpm
+ AddButtonStyle 2 Inactive pixmap buttons/grayglass_close.xpm
+ AddButtonStyle 2 ActiveDown pixmap buttons/redglass_close_pressed.xpm
	
+ ButtonStyle 1 - MwmDecorMenu
+ ButtonStyle 6 - MwmDecorMin
+ ButtonStyle 4 - MwmDecorMax

Style * UseDecor DefaultDecor

#####
# Application specific Style settings
#
# You might be interested in the IconOverride style, which will allow you to specify
# an Icon for an application even if it has set its own previously, This can be very
# useful for applications that insist on setting their own icons even if it doesnt
# fit in with your theme :)
#
# -taviso
#################
Style FvwmPager   NoTitle,  Sticky, WindowListSkip, CirculateSkipIcon, CirculateSkip
Style FvwmPager   StaysOnBottom, NoHandles, BorderWidth 1
Style FvwmBanner  NoTitle
Style FvwmButtons NoTitle, StaysOnBottom, Sticky, WindowListSkip, CirculateSkipIcon, CirculateSkip
Style FvwmButtons HandleWidth 2, NeverFocus, Layer 1
Style FvwmTaskBar NoTitle, WindowListSkip, CirculateSkip, Sticky, BorderWidth 0, NoHandles, StaysOnBottom
Style FvwmTaskBar NeverFocus, Layer 0
Style XTerm       MiniIcon computer_x11.png
Style xcalc       ClickToFocus
Style xman        ClickToFocus, MiniIcon book_help_paper.png
Style xmag        ClickToFocus, MiniIcon document_database_view.png
Style Gkrellm2    Sticky, WindowListSkip, StaysOnBottom, NeverFocus
Style opera       EWMHMiniIconOverride, MiniIcon opera.png
Style XVroot      GrabFocus
Style grun        MiniIcon gears.png
Style FvwmIdent   MiniIcon label_tag_version.png
Style Calculator  MiniIcon calculator.png
Style beep-media-player MiniIcon audio_horn.png
Style xmessage    MiniIcon person_face_talking.png
Style aterm       WindowShadeShrinks
Style rxvt        WindowShadeShrinks
Style Mulberry    MiniIcon mail.png
Style Message     MiniIcon person_face_talking.png
Style VMware      MiniIcon hardware_computers.png
Style SDL_App     EWMHMiniIconOverride, MiniIcon games_jesters-cap.png
Style XDosEmu     EWMHMiniIconOverride, MiniIcon games_jesters-cap.png
Style FvwmScript-Quit MiniIcon plug.png
Style __messages_root Sticky, WindowListSkip, NoTitle
Style __messages_root BorderWidth 0, StaysOnBottom, NoHandles, NeverFocus
Style nautilus    EWMHMiniIconOverride, MiniIcon floppy_disk.png
Style abiword     EWMHMiniIconOverride, MiniIcon document_letter_word-processor.png
Style grip        EWMHMiniIconOverride, MiniIcon hardware_audio_cd.png
Style xv          MiniIcon graphics_woman_panel.png
Style MPlayer*	  Sticky, StaysOnTop
Style *Chat*	  Sticky, StaysOnTop
Style xchat-2	  Slippery, StaysPut

# AutoHiding Console
#Style HiddenConsole Sticky, WindowListSkip, Notitle, StaysOnTop, NoHandles
#Style HiddenConsole WindowShadeSteps 100

#####
# Miscellaneous Module Settings.
#
# -taviso
#################

# FvwmIdent is an xwininfo replacement.
DestroyModuleConfig FvwmIdent: *
*FvwmIdent: Back MidnightBlue
*FvwmIdent: Fore #f6f6f6
*FvwmIdent: Font "xft:snap"

# FvwmScroll swallows applications into smaller containers.
DestroyModuleConfig FvwmScroll: *
*FvwmScroll: Back #f6f6f6
*FvwmScroll: Fore #f6f6f6

# FvwmEvent can bind Commands to Events
DestroyModuleConfig FvwmEvent: *

# Animations are controlled by this module
# You could also use Frame, Lines, Flip, Turn, Twist, Random and None.
DestroyModuleConfig FvwmAnimate: *
*FvwmAnimate: Effect Flip

# Hit Alt+Esc to toggle FvwmProxy, which allows you to see all windows on your
# desktop, even if they've been obscured..really cool.
DestroyModuleConfig FvwmProxy: *
*FvwmProxy: Font "xft:snap"
*FvwmProxy: ProxyMove true

Key Escape  A   M   SendToModule FvwmProxy ShowToggle

#####
# Mouse bindings.
#
# -taviso
#################

# Syntax Reminder:
# Mouse Button Context Modifiers Function

Mouse 2 R       A   Menu MenuFvwmRoot
Mouse 4 R       A   Menu MenuFvwmRoot
Mouse 5 R       A   Menu MenuFvwmRoot
Mouse 2 R       A   WindowList
Mouse 0 1       A   Menu MenuFvwmWindowOps Nop
Mouse 0 2       A   DestroyOnHold
Mouse 0 6       A   Thumbnail
Mouse 0 4       A   Maximize
Mouse 4 T       A   WheelToggleShade True
Mouse 5 T       A   WheelToggleShade False
Mouse 1 FS      A   Resize-or-Raise
Mouse 1 T       A   Move-or-Raise
Mouse 1 I       A   Move-or-Iconify
Mouse 2 I       A   Iconify
Mouse 3 TSIF    A   RaiseLower
Mouse 3 W       M   Menu Window-Ops Nop
Mouse 2 W       C   Resize-or-Raise
Mouse 1 W       M   Move-or-Raise
# Reserved for Mouse Gestures (See below)
Mouse 3 R      A   -

#####
# Functions and mouse bindings to allow using the mouse
# wheel on the root window to cycle through desktops,
# a la fluxbox.  Original basic version for 2x2 found on
# the Gentoo forums.  Extra lines added to allow a 3x3
# pager setup.
#
# -xiphux
#################
AddToFunc PageNext
+ "I"   PipeRead '\
  if [ $$[page.nx] -eq 0 ];\
    then echo "GotoPage 1 $$[page.ny]";\
  elif [ $$[page.nx] -eq 1 ];\
    then echo "GotoPage 2 $$[page.ny]";\
  elif [ $$[page.ny] -eq 0 ];\
    then echo "GotoPage 0 1";\
  elif [ $$[page.ny] -eq 1 ];\
    then echo "GotoPage 0 2";\
  else echo "GotoPage 0 0";\
  fi'

AddToFunc PagePrev
+ "I"   PipeRead '\
  if [ $$[page.nx] -eq 2 ];\
    then echo "GotoPage 1 $$[page.ny]";\
  elif [ $$[page.nx] -eq 1 ];\
    then echo "GotoPage 0 $$[page.ny]";\
  elif [ $$[page.ny] -eq 2 ];\
    then echo "GotoPage 2 1";\
  elif [ $$[page.ny] -eq 1 ];\
    then echo "GotoPage 2 0";\
  else echo "GotoPage 2 2";\
  fi'

Mouse 4 R       A       PageNext
Mouse 5 R       A       PagePrev 



#####
# Key bindings.
#
# -taviso
#################
Key F1 A        M   GotoPage 0 0
Key F2 A        M   GotoPage 1 0
Key F3 A        M   GotoPage 2 0
Key F4 A        M   GotoPage 0 1
Key F5 A	M   GotoPage 1 1
Key F6 A	M   GotoPage 2 1
Key F7 A	M   GotoPage 0 2
Key F8 A	M   GotoPage 1 2
Key F9 A	M   GotoPage 2 2
Key F10 A	M   FvwmExpose
Key X  A        4   Pick Destroy
Key L  A        4   Exec exec xscreensaver-command --lock
Key I  A        4   All (AcceptsFocus CurrentPage !Iconic !Shaded) Thumbnail
Key C  A        CM  Exec exec xcalc
Key G  A        CM  Exec exec gaim
Key N  A        CM  Exec exec pan
Key M  A        CM  Exec exec mulberry
Key O  A        CM  Exec exec opera -newpage
Key V  A        CM  Exec exec gvim -geom 115x46
Key B  A        CM  Exec exec beep-media-player
Key X  A        CM  Exec exec xmag
Key S  A        CM  Exec exec aterm -g 102x42 -title '.: s d f :.' -e ssh tty.freeshell.org
Key F4 A        CM  Quit
Key R  A        CM  Restart
Key Up      WTSF    SM  PackWrapperUp
Key Down    WTSF    SM  PackWrapperDown
Key Left    WTSF    SM  PackWrapperLeft
Key Right   WTSF    SM  PackWrapperRight

Key F14 A	N   Exec exec amixer sset Master,0 3-
Key Help A	N   Exec exec amixer sset Master,0 3+

####
# Mouse Gestures.
#
# Syntax reminder:
#
#   1   2   3
#
#   4   5   6
#
#   7   8   9
#
# Stroke Sequence Button Context Modifiers Function
#
# I use mouse gestures in Opera and Mozilla, so I've duplicated some common ones here.
#
# To try these out, hold down the Left mouse button and trace the pattern on the Root
# Window, the sequence is a pattern on the grid above, so 14789 would be down then Right.
#
# -taviso
#################

####
# First, define a StrokeFunc.
#
# Without this, you would have to execute all of your gestures entirely on the Root
# Window, This lets you change the Context and have a few other Neat Features, such as
# DrawMotion, which will draw a line as you make your Gesture (Neat!).
#
# There is also EchoSequence, Feedback and NotStayPressed.
#
# Note: EchoSequence prints sequences to STDERR.
#
# -taviso
#################
Mouse 3 R A     StrokeFunc DrawMotion FeedBack StrokeWidth 1

# Down, Then Up.
Stroke 25852 0 R N  Refresh

# Directions...
Stroke 456 0 R N    GotoPage +1p 0p
Stroke 654 0 R N    GotoPage -1p 0p
Stroke 852 0 R N    GotoPage 0p -1p
Stroke 258 0 R N    GotoPage 0p +1p

# Diagonal...
Stroke 159 0 R N    GotoPage +1p +1p
Stroke 951 0 R N    GotoPage -1p -1p
Stroke 357 0 R N    GotoPage -1p +1p
Stroke 753 0 R N    GotoPage +1p -1p

#####
# Quit
#
# Down, Then Right.
#
# Dont worry about running this gesture by accident,
# you will be asked to confirm
#
# -taviso
#################
Stroke 14789 0 R N  Module FvwmForm FvwmForm-QuitVerify

####
# Up, Then Down: Close a window.
#
# Note that you can also enter the sequence as it appears on your
# Numeric Keypad, by preceding the sequence with an `N`.
#
# The FVWM developers think of everything :)
#
# -taviso
#################
Stroke N25852 0 R N Pick Close

# Start a Web Browser
Stroke N1478963 0 R N Exec exec opera -newpage

# Make a new Sticky Note
Stroke N1598753 0 R N Exec exec xpad

#####
# Fvwm executes StartFunction when Fvwm is initialized, and at restart.
# A Good place to start Modules.
#
# FvwmCommandS Allows you to run Fvwm Commands from a Terminal, like this:
#   $ FvwmCommand 'Module FvwmBanner'
# Or any other Command.
#
# You can test for Initialization from within StartFunction, this is a good
# place to set the Background or start your favourite applications.
#
# -taviso
#################
AddToFunc StartFunction
+ I Module FvwmCommandS
+ I Module FvwmAnimate
+ I Module FvwmEvent
+ I Module FvwmProxy
+ I Module FvwmAuto FvwmAutohide -menter FuncAutoEnter
+ I Module FvwmButtons -g 126x864-0+0
+ I Module FvwmTaskBar
#+ I Test (Init) Exec exec fvwm-root --dither --retain-pixmap $[fvwm_wallpaper]
+ I Test (Restart) All (Iconic) Test (f $[HOME]/.fvwm/icon.tmp.$[w.id].png) WindowStyle IconOverride, Icon $[HOME]/.fvwm/icon.tmp.$[w.id].png

#####
# I Sometimes use xsm, but dont usually bother.
#
# -taviso
#################
#AddToFunc SessionInitFunction I Nop
#AddToFunc SessionRestartFunction I Nop

#####
# ExitFunction is executed when you ask Fvwm to Quit.
# Test (ToRestart) is true before a Restart.
#
# -taviso
#################
AddToFunc ExitFunction
+ I Test (!ToRestart) Exec exec rm -f $[HOME]/.fvwm/icon.tmp.*
+ I Exec exec sync

#####
# Autohide console example: [4]http://dev.gentoo.org/~taviso/autohide_console.png
#
# -taviso
##################
#DestroyFunc StartHiddenConsole
#AddToFunc StartHiddenConsole
#+ I Exec exec rxvt +sb -geometry 144x8+0+0 -name HiddenConsole
#+ I Wait HiddenConsole
#+ I Autohide HiddenConsole 250 0 N

#####
# Menu definitions
# Beep if theres a missing SubMenu to remind me to write it.
#
# -taviso
# -xiphux (menu rewritten)
#################
DestroyMenu MenuFvwmRoot
AddToMenu MenuFvwmRoot
+   MissingSubmenuFunction                  Beep
+   "&mgt"				    Exec exec multi-gnome-terminal
+   "&dzt"				    Exec exec dzt
+   ""                                      Nop
+   "internet"              		    Popup MenuInternet
+   "games"        			    Popup MenuGames
+   "productivity"                     	    Popup MenuProductivity
+   "video"                		    Popup MenuVideo
+   "audio"       			    Popup MenuAudio
+   "graphics"   			    Popup MenuGraphics
+   "utilities"        			    Popup MenuUtilities
+   ""                                      Nop
+   "fvwmconsole"			    Module FvwmConsole -terminal rxvt
+   "preferences"               	    Popup MenuFvwmConfig
+   "window controls"      		    Popup MenuFvwmWindowOps
+   ""                                      Nop
+   "processes"				    Popup MenuProcess
+   ""					    Nop
+   "&xkill"          			    Pick Destroy
+   "&refresh"  			    Refresh
+   "&screenshot"      			    Exec exec scrot --quality 100 '%Y-%m-%d_$wx$h.png'
+   ""                                      Nop
+   "exit"        			    Popup MenuQuit-Verify

DestroyMenu MenuInternet
AddToMenu MenuInternet
+   "mozilla firefox"			    Exec exec firefox
+   "links"				    Exec exec links2 -g -driver x
+   "gossip"				    Exec exec gossip
+   "xchat"				    Exec exec xchat-2
+   "gftp"				    Exec exec gftp
+   "opera"				    Exec exec /opt/opera/bin/opera
+   ""					    Nop
+   "epiphany"				    Exec exec epiphany
+   "galeon"				    Exec exec galeon
+   "mozilla"				    Exec exec /usr/bin/mozilla
+   "mozilla composer"			    Exec exec mozilla -edit
+   "gaim"				    Exec exec gaim
+   "ethereal"				    Exec exec ethereal
+   "gnomba"				    Exec exec gnomba
+   "logjam"				    Exec exec logjam
+   "sylpheed-claws"			    Exec exec sylpheed-claws
+   "gtk-gnutella"			    Exec exec gtk-gnutella
+   "d4x"				    Exec exec nt
+   "nmap"				    Exec exec nmapfe
+   "deadftp"				    Exec exec deadftp
+   "easyftp"				    Exec exec easyFTP
+   "ftpcube"				    Exec exec ftpcube
+   "gabber"				    Exec exec gabber
+   "dc_gui"				    Exec exec dc_gui
+   "qt_dcgui"				    Exec exec dcgui
+   "fidelio"				    Exec exec fidelio
+   "lopster"				    Exec exec lopster
+   "bk_edit"				    Exec exec bk_edit
+   "screem"				    Exec exec screem
+   "giFToxic"				    Exec exec giFToxic
+   "mldonkey"				    Exec exec mldonkey
+   "kazaa lite k++"			    Exec exec wine /home/xiphux/.wine/fake_windows/Program\ Files/Kazaa\ Lite\ K++/kpp.exe
+   "liferea"				    Exec exec liferea
+   "xtraceroute"			    Exec exec xtraceroute
+   "gnome-jabber"			    Exec exec gnome-jabber

DestroyMenu MenuGames
AddToMenu MenuGames
+   "abuse.sdl" 		    Exec exec abuse.sdl
+   "quake 2" 			    Exec exec quake2
+   "quake 2 ctf"                   Exec exec quake2 +set game ctf
+   "freespace 2" 		    Exec exec /home/xiphux/scripts/freespace2.sh
+   "quake 3" 			    Exec exec /usr/games/bin/quake3
+   "falconseye" 		    Exec exec falconseye
+   "freeciv server" 		    Exec exec civserver
+   "freeciv client" 		    Exec exec civclient
+   "freecraft" 		    Exec exec /usr/share/freecraft/freecraft
+   "heroes" 			    Exec exec heroes
+   "lsdldoom" 			    Exec exec lsdldoom
+   "doom legacy" 		    Exec exec llxdoom -opengl
+   "maelstrom" 		    Exec exec maelstrom
+   "freecell" 			    Exec exec freecell
+   "minesweeper" 		    Exec exec gnomine
+   "mahjongg" 			    Exec exec mahjongg
+   "xscorch" 			    Exec exec xscorch
+   "unreal tournament" 	    Exec exec ut
+   "ladystar" 			    Exec exec firefox /storage/ladystar/welcome.html
+   "diablo ii" 		    Exec exec /home/xiphux/scripts/diablo2
+   "phobia3" 			    Exec exec /home/xiphux/scripts/phobia3
+   "vendetta" 			    Exec exec vendetta
+   "vegastrike" 		    Exec exec vslauncher
+   "glaxium" 			    Exec exec /home/xiphux/scripts/glaxium.sh
+   "ut2003-demo" 		    Exec exec ut2003-demo
+   "quake" 			    Exec exec nq-glx
+   "quakeworld" 		    Exec exec qw-client-glx
+   "ut2003 full" 		    Exec exec ut2003
+   "lincity"			    Exec exec lincity
+   "egoboo" 			    Exec exec egoboo
+   "zangband" 			    Exec exec zangband
+   "serious sam" 		    Exec exec ssamtfe
+   "chromium" 			    Exec exec /usr/games/bin/chromium
+   "chromium-setup" 		    Exec exec /usr/games/bin/chromium-setup
+   "cube" 			    Exec exec /usr/games/bin/cube_client
+   "bombermaze" 		    Exec exec bombermaze
+   "cuyo" 			    Exec exec /usr/games/bin/cuyo
+   "loki_update" 		    Exec exec /usr/games/ut2003/updater/loki_update
+   "racer" 			    Exec exec /home/xiphux/scripts/racer
+   "pysol" 			    Exec exec pysol
+   "neverwinter nights" 	    Exec exec /home/xiphux/scripts/nwn
+   "snes9x" 			    Exec exec goosnes
+   "magiccube4d" 		    Exec exec /home/xiphux/magiccube4d-linux-bin-2_1/magiccube4d
+   "crack-attack"		    Exec exec crack-attack --solo
+   "enigma"			    Exec exec enigma
+   "kiki" 			    Exec exec kiki
+   "dosbox" 			    Exec exec dosbox
+   "slashem" 			    Exec exec slashem
+   "noegnud-slashem" 		    Exec exec noegnud-slashem

DestroyMenu MenuProductivity
AddToMenu MenuProductivity
+   "gedit"			    Exec exec gedit
+   "gnumeric"			    Exec exec gnumeric
+   "abiword"			    Exec exec abiword-2.0
+   "calcoo"			    Exec exec calcoo
+   "anjuta"			    Exec exec anjuta
+   "glade-2"			    Exec exec glade-2
+   ""				    Nop
+   "xemacs"			    Exec exec xemacs
+   "gnucash"			    Exec exec gnucash
+   "bluefish"			    Exec exec bluefish
+   "texmacs"			    Exec exec texmacs
+   "siag"			    Exec exec siag
+   "xpdf"			    Exec exec xpdf
+   "openoffice"		    Exec exec oowriter
+   "acroread"			    Exec exec /opt/Acrobat5/acroread
+   "eTktab"			    Exec exec /home/xiphux/eTktab-2.5/eTktab
+   "gvim"			    Exec exec gvim
+   "lyx"			    Exec exec lyx
+   "gmp"			    Exec exec gmp
+   "jedit"			    Exec exec jedit
+   "wxglade"			    Exec exec wxglade
+   "gnuplot"			    Exec exec gnuplot
+   "boa-constructor"		    Exec exec boa-constructor
+   "spe"			    Exec exec spe

DestroyMenu MenuVideo
AddToMenu MenuVideo
+   "mplayer"			    Exec exec mplayer
+   "ogle"			    Exec exec ogle
+   "" 				    Nop
+   "xine"			    Exec exec xine
+   "sinek"			    Exec exec sinek
+   "realplayer8"		    Exec exec /opt/RealPlayer8/realplay
+   "realone"			    Exec exec /home/xiphux/RealPlayer9/realplay
+   "drip"			    Exec exec drip
+   "dvdrip"			    Exec exec dvdrip
+   "cinelerra"			    Exec exec cinelerra
+   "xmovie"			    Exec exec xmovie
+   "helix-player"		    Exec exec hxplay

DestroyMenu MenuAudio
AddToMenu MenuAudio
+   "rhythmbox (isochronous)"	    Exec exec schedtool -I -e rhythmbox
+   "rhythmbox"			    Exec exec rhythmbox
+   "wxMusik"			    Exec exec wxMusik
+   "beep-media-player"		    Exec exec beep-media-player
+   "easytag"			    Exec exec easytag
+   ""				    Nop
+   "musik"			    Exec exec Musik
+   "xmms"			    Exec exec xmms
+   "madman"			    Exec exec madman
+   "alsamixer"			    Exec exec xterm -e alsamixer
+   "alsamixergui"		    Exec exec alsamixergui
+   "gamix"			    Exec exec gamix
+   "grip"			    Exec exec grip
+   "reborn"			    Exec exec reborn
+   "alsaplayer"		    Exec exec alsaplayer
+   "ripperX"			    Exec exec ripperX
+   "zinf"			    Exec exec zinf
+   "rezound"			    Exec exec rezound
+   "aumix"			    Exec exec aumix
+   "galan"			    Exec exec galan
+   "hydrogen"			    Exec exec hydrogen
+   "protux"			    Exec exec protux
+   "spiralsynthmodular"	    Exec exec spiralsynthmodular
+   "trommler"			    Exec exec trommler
+   "beast"			    Exec exec beast
+   "sweep"			    Exec exec sweep

DestroyMenu MenuGraphics
AddToMenu MenuGraphics
+   "gqview"			    Exec exec gqview
+   "gimp"			    Exec exec gimp
+   ""				    Nop
+   "blender"			    Exec exec blender
+   "electric eyes"		    Exec exec ee
+   "gPov"			    Exec exec gPov
+   "giram"			    Exec exec giram
+   "celestia"			    Exec exec celestia
+   "peflp"			    Exec exec /home/xiphux/peflp/peflp
+   "sodipodi"			    Exec exec sodipodi

DestroyMenu MenuUtilities
AddToMenu MenuUtilities
+   "emelfm"			    Exec exec emelfm
+   "vmware"			    Exec exec vmware
+   "gkrellm"			    Exec exec gkrellm2 -w
+   "gkrellm - centraldogma"	    Exec exec gkrellm2 -f -s 192.168.0.119 -P 19150 -w
+   "gkrellm - nerv"		    Exec exec gkrellm2 -f -s 192.168.0.1 -P 19150 -w
+   ""				    Nop
+   "idesk"			    Exec exec idesk
+   "gentoo"			    Exec exec gentoo
+   "ghex"			    Exec exec ghex
+   "portagemaster"		    Exec exec portagemaster
+   "nautilus"			    Exec exec nautilus
+   "worker"			    Exec exec worker
+   "velocity"			    Exec exec velocity
+   "seahorse"			    Exec exec seahorse
+   "nedit"			    Exec exec nedit
+   "gtkdiskfree"		    Exec exec gtkdiskfree
+   "rox"			    Exec exec rox
+   "gcombust"			    Exec exec gcombust
+   "xcdroast"			    Exec exec xcdroast
+   "simplecdrx"		    Exec exec simplecdrx
+   "coaster"			    Exec exec coaster
+   "cdw"			    Exec exec cdw -g
+   "usbview"			    Exec exec usbview
+   "gtop"			    Exec exec gtop
+   "xkeycaps"			    Exec exec xkeycaps
+   "procman"			    Exec exec procman
+   "nvtv"			    Exec exec nvtv
+   "xnc"			    Exec exec xnc
+   "ufed"			    Exec exec xterm -e ufed
+   "switch2"			    Exec exec switch2

#####
# Functions to allow a process list popup menu.
# Processes are listed by pid, and each has its
# own popup with the process state, parent, nice,
# and various killing/nicing options.
# Adapted from an example found on the Gentoo forums.
# Calls two external scripts: fvwm-process-menu and
# get-proc-info.
#
# -xiphux
#################
DestroyMenu MenuProcess
AddToMenu MenuProcess Processes title
+ DynamicPopupAction Function GetProcessList

AddToFunc GetProcessList
+ I DestroyMenu recreate MenuProcess
+ I AddToMenu MenuProcess Processes title
+ I PipeRead 'echo "`$HOME/scripts/fvwm-process-menu`"'

DestroyFunc GetProcInfo
AddToFunc GetProcInfo
+ I DestroyMenu recreate $0
+ I AddToMenu $0
+ I Piperead 'echo "`$HOME/scripts/get-proc-info $0`"'


#####
# I start fvwm from my ~/.xinitrc like this:
#   exec ssh-agent fvwm2
# So if i select "Add Agent Identity" from this menu, it adds my default ssh key to ssh-agent.
#
# -taviso
#################
DestroyMenu MenuLogins
AddToMenu MenuLogins
+   %telephone_out.png%"SDF Public Access UNIX System"%ctl_alt_s.png%   Exec exec aterm -g \
        102x42 -title '.: s d f :.' -e ssh tty.freeshell.org
+   %computer_network.png%"Gentoo Linux Dev Server" Exec exec aterm -g \
        102x42 -title '.: t e r m i n a l :.' -e ssh dev.gentoo.org
+   %key2.png%"Add Agent Identity"  Exec ssh-add < /dev/null || ( test -x /usr/lib/misc/ssh-askpass || xmessage "Please install net-misc/x11-ssh-askpass." )
+   ""                                      Nop
+   %computer_x11.png%"Large Terminal Emulator" Exec exec aterm -g 102x42 -title '.: t e r m i n a l :.'
+   %computer_x11.png%"Mini Terminal Emulator"  Exec exec rxvt -g 63x8 -title '.: m i n i t e r m :.' -e sh

#####
# You can browse directories and files with the fvwm-menu-directory
# script included with Fvwm, its very configurable (as you might expect!),
# and very useful.
#
# [5]http://www.mail-archive.com/fvwm%40hpc.uh.edu/msg05260.html
#
# -taviso
#################
DestroyFunc FuncFvwmMenuDirectory
AddToFunc FuncFvwmMenuDirectory
+ I PipeRead 'case $0 in \
        $[fvwm_rom_path]*) myexec=$[fvwm_rom_exec] mypng=games_puzzles_dice.png;; \
        $[fvwm_video_path]*) myexec=$[fvwm_video_exec] mypng=film.png;; \
        $[fvwm_audio_path]*) myexec=$[fvwm_audio_exec] mypng=audio.png;; \
        $[fvwm_image_path]*) myexec=$[fvwm_image_exec] mypng=graphics_presentation_person.png;; \
    esac; \
    fvwm-menu-directory --icon-title folder_view.png --icon-file ${mypng:-file_text_view.png} \
    --icon-dir folder_paper_closed.png --dir $0 --xterm exec --exec-file ${myexec:-gvim}'

DestroyMenu MenuQuit-Verify
AddToMenu MenuQuit-Verify
+   %plug.png%"Quit Fvwm Now"%ctl_alt_f4.png%   Quit
+   %gears.png%"Restart Fvwm..."%ctl_alt_r.png% Restart
+   ""                                  Nop
+   %cursor.png%"Restart twm"           Restart twm
+   %computer_x11.png%"Restart xterm"   Restart xterm
+   ""                                  Nop
+   %hardware_mouse.png%"Cancel"        Nop

DestroyMenu MenuFvwmConfig
AddToMenu MenuFvwmConfig
+   %graphics_palette_view.png%"Colour Browser" Exec exec gcolor
+   %document_view.png%"Edit fvwm2rc"   Exec exec gvim -geom 115x46 ~/.fvwm/.fvwm2rc
+   ""                                  Nop
+   %plug.png%"Fvwm Modules"            Popup MenuFvwmModules
+   ""                                  Nop
+   %widget_buttons.png%"Configure FvwmForm..." Module FvwmForm FvwmForm-Form
+   %cursor.png%"Configure Cursor..."   Module FvwmForm FvwmForm-RootCursor
+   %television.png%"Configure Screensaver..."  Exec exec xscreensaver-demo
+   %hardware_mouse.png%"Configure Mouse..."    Module FvwmScript FvwmScript-PointerSetup
+   %hardware_keyboard.png%"Configure Keyboard..." Module FvwmScript FvwmScript-KeyboardSetup
+   %audio.png%"Configure Bell..."      Module FvwmScript FvwmScript-BellSetup
+   %tool_wrench.png%"General Settings..."  Module FvwmScript FvwmScript-BaseConfig

#####
# `Pick` is very handy, if it's obvious which window you're talking about,
# The command is executed immediately within the context of that window.
#
# If it isnt obvious, for example, you select `Move` from the Root menu, the
# cursor becomes a crosshair, and you can select the window you you would like
# to apply the command to by clicking it.
#
# This saves a lot of work, you can use `Pick` with everything that might be
# Called without context and only write one function/menu instead of two.
#
# -taviso
#################
DestroyMenu FvwmMoveMethods
AddToMenu FvwmMoveMethods
+   "Move to Top"       Pick AnimatedMove keep 0p
+   "Move to Left"      Pick AnimatedMove 0p keep
+   "Move to Right"     Pick PipeRead \
        "echo AnimatedMove `expr $[vp.width] - $[w.width]`p keep"
+   "Move to Bottom"    Pick PipeRead \
        "echo AnimatedMove keep `expr $[vp.height] - $[w.height]`p"
+   ""                              Nop
+   %window.png%"Center Window" Pick PipeRead \
    "echo AnimatedMove `expr \\( $[vp.width] - $[w.width] \\) / 2`p \
    `expr \\( $[vp.height] - $[w.height] \\) / 2`p"
+   ""                              Nop
+   %hardware_mouse.png%"Pack Up"%alt_sft_up.png%   Pick PackWrapperUp
+   %hardware_mouse.png%"Pack Left"%alt_sft_left.png%   Pick PackWrapperLeft
+   %hardware_mouse.png%"Pack right"%alt_sft_right.png% Pick PackWrapperRight
+   %hardware_mouse.png%"Pack down"%alt_sft_down.png%   Pick PackWrapperDown
+   ""                              Nop
+   %numbers_counter.png%"Move To Page" Popup MenuPageList
+   ""                              Nop
+   %hardware_mouse.png%"Interactive Move"  Pick Move

DestroyMenu MenuPageList
AddToMenu MenuPageList
+ "1"   Pick MoveToPage 0 0
+ "2"   Pick MoveToPage 1 0
+ "3"   Pick MoveToPage 2 0
+ "4"   Pick MoveToPage 0 1
+ "5"   Pick MoveToPage 1 1
+ "6"   Pick MoveToPage 2 1
+ "7"   Pick MoveToPage 0 2
+ "8"   Pick MoveToPage 1 2
+ "9"   Pick MoveToPage 2 2

#####
# WindowOps, Main window controls menu.
#
# -taviso
#################
DestroyMenu MenuFvwmWindowOps
AddToMenu MenuFvwmWindowOps
+   %paper_geometry.png%"Resize"            Pick Resize
+   "Iconify   "                            Pick Iconify
+   "Thumbnail "                            Pick Thumbnail
+   "Maxmimise"                             Pick Maximize
+   %hardware_mouse.png%"Move"              Popup FvwmMoveMethods
+   %window-blind.png%"Shade"               Pick WindowShade Toggle
+   ""  Nop
+   %capture_mouse-trap.png%"Stick"         Pick Stick
+   %hardware_mouse.png%"Scroll"            Pick Module FvwmScroll
+   %graphics_convert_polaroid.png%"Refresh"    Pick RefreshWindow
+   ""  Nop
+   %label_tag_version.png%"Identify"       Pick Module FvwmIdent
+   %document_database_view.png%"Zoom"      Pick Exec exec xmag -source $[w.width]x$[w.height]+$[w.x]+$[w.y] -mag 2
+   ""  Nop
+   %bomb.png%"Close"		            Pick Close
+   %warning_symbol.png%"Destroy"	    Pick Destroy

DestroyMenu MenuFvwmModules
AddToMenu MenuFvwmModules
+   "Animation          "   Module FvwmAnimate
+   "Button-Bar         "   Module FvwmButtons
+   "Identify           "   Module FvwmIdent
+   "IconMan            "   Module FvwmIconMan
+   "Banner             "   Module FvwmBanner
+   "Console            "   Module FvwmConsole -terminal rxvt
+   "Pager              "   Module FvwmPager 0 1
+   "Backer             "   Module FvwmBacker
+   "ScrollBar          "   Module FvwmScroll 50 50
+   "FvwmTaskBar        "   Module FvwmTaskBar
+   "AutoRaise          "   Module FvwmAuto 200 Raise Nop
+   "WinList            "   Module FvwmWinList
+   ""                      Nop
+   "Stop Module        "   Popup  MenuFvwmStopModule

DestroyMenu MenuFvwmStopModule
AddToMenu MenuFvwmStopModule
+   "Stop Button-Bar    "   KillModule FvwmButtons
+   "Stop IconMan       "   KillModule FvwmIconMan
+   "Stop Pager         "   KillModule FvwmPager
+   "Stop Backer        "   KillModule FvwmBacker
+   "Stop ScrollBar     "   KillModule FvwmScroll
+   "Stop FvwmTaskBar   "   KillModule FvwmTaskBar
+   "Stop AutoRaise     "   KillModule FvwmAuto
+   "Stop WinList       "   KillModule FvwmWinList

#####
# Name:     FuncFvwmFocusPolicyChange
# Bound:    MenuFvwmConfig, Focus Policy Changes.
# Purpose:  Start using a new Focus Policy.
#
# -taviso
#################
DestroyFunc FuncFvwmFocusPolicyChange
AddToFunc FuncFvwmFocusPolicyChange
+ I Style * $0
+ I Recapture

#####
# Name:     PackWindowUp
# Bound:    Alt+Shift+Up When a window is active
# Purpose:  Interrogate all windows on the current page, find the window with an edge
#           closest to active window, and slide the Active window upto that edge, or
#           the Page edge, if no window is in the way.
#
#           The Wrappers are required to look after the Context while we're testing
#           windows. Could also do it with a load of variables, but this is nicer.
#
#           See PackWindowLeft for a description of the logic (i know it looks a little
#           cryptic).
#
#           Sometimes terminals seem to need WindowRefresh, but 99% of the time it just
#           works, it creates a little flicker so I'll leave it out until it starts to bug
#           me.
#
#           Windows are also Raised, you can disable this.
#
# -taviso
#################
DestroyFunc PackWindowUp
AddToFunc PackWindowUp
+ I SetEnv low_w 0
+ I WindowId $3 Raise
+ I All (CurrentPage !Iconic AcceptsFocus \
        !Shaded) PipeRead "test `expr $[w.y] + $[w.height]` -gt $[low_w] \
        -a `expr $[w.y] + $[w.height]` -lt $0 \
        -a \\( \\( $[w.x] -gt $1 -a $[w.x] -lt `expr $1 + $2` \\) \
            -o \\( $1 -gt $[w.x] -a $1 -lt `expr $[w.x] + $[w.width]` \\) \
            -o \\( $1 -le $[w.x] -a `expr $1 + $2` -ge `expr $[w.x] + $[w.width]` \\) \
            -o \\( $[w.x] -lt $1 -a `expr $[w.x] + $[w.width]` -gt `expr $1 + $2` \\) \
        \\) \
        && echo SetEnv low_w `expr $[w.y] + $[w.height]` \
        || echo Nop"
+ I WindowId $3 AnimatedMove keep $[low_w]p
#+ I WindowId $3 RefreshWindow

AddToFunc PackWrapperUp I NoWindow PackWindowUp $[w.y] $[w.x] $[w.width] $[w.id]

#####
# Name:     PackWindowDown
# Bound:    Alt+Shift+Down When a window is active.
# Purpose:  See PackWindowUp.
#
# -taviso
#################
DestroyFunc PackWindowDown
AddToFunc PackWindowDown
+ I SetEnv high_w $[vp.height]
+ I WindowId $3 Raise
+ I All (CurrentPage !Iconic AcceptsFocus \
        !Shaded) PipeRead "test $[w.y] -lt $[high_w] \
        -a $[w.y] -gt `expr $0 + $4`  \
        -a \\( \\( $[w.x] -gt $1 -a $[w.x] -lt `expr $1 + $2` \\) \
            -o \\( $1 -gt $[w.x] -a $1 -lt `expr $[w.x] + $[w.width]` \\) \
            -o \\( $1 -le $[w.x] -a `expr $1 + $2` -ge `expr $[w.x] + $[w.width]` \\) \
            -o \\( $[w.x] -lt $1 -a `expr $[w.x] + $[w.width]` -gt `expr $1 + $2` \\) \
        \\) \
        && echo SetEnv high_w $[w.y] \
        || echo Nop"
+ I PipeRead "echo WindowId $3 AnimatedMove keep `expr $[high_w] - $4`p"
#+ I WindowId $3 RefreshWindow

AddToFunc PackWrapperDown I NoWindow PackWindowDown $[w.y] $[w.x] $[w.width] $[w.id] $[w.height]

#####
# Name:     PackWindowLeft
# Bound:    Alt+Shift+Left When a window is active
# Purpose:  See PackWindowUp.
#
# The Logic works likes this:
#   1. Set Destination to the Left Edge
#   2. For every window, Run these tests:
#               + Is the Window's Right edge further _Right_ than furthest edge seen yet?
#       And:    + Is it's Right edge Further _Left_ than Target Windows Left edge? (ie, in the way)
#           Yes:
#                   + Does the window start inside Target Window, and end below?
#               Or  + Does it start above, and end inside?
#               Or  + Is it the same vertical position/height/size, or start inside and end inside?
#               Or  + Does it start above, and end below?
#                   Yes:
#                       This is the new Destination.
#                   No:
#                       Nop
#           No:
#               Nop
#   3. Move to Destination.
#
# -taviso
#################
DestroyFunc PackWindowLeft
AddToFunc PackWindowLeft
+ I SetEnv left_w 0
+ I WindowId $3 Raise
+ I All (CurrentPage !Iconic AcceptsFocus \
        !Shaded) PipeRead "test `expr $[w.x] + $[w.width]` -gt $[left_w] \
        -a `expr $[w.x] + $[w.width]` -lt $1 \
        -a \\( \\( $[w.y] -gt $0 -a $[w.y] -lt `expr $0 + $4` \\) \
            -o \\( $[w.y] -lt $0 -a `expr $[w.y] + $[w.height]` -gt $0 \\) \
            -o \\( $[w.y] -ge $0 -a `expr $[w.y] + $[w.height]` -le `expr $0 + $4` \\) \
            -o \\( $[w.y] -lt $0 -a `expr $[w.y] + $[w.height]` -gt `expr $0 + $4` \\) \
        \\) \
        && echo SetEnv left_w `expr $[w.x] + $[w.width]`  \
        || echo Nop"
+ I WindowId $3 AnimatedMove $[left_w]p keep
#+ I WindowId $3 RefreshWindow

AddToFunc PackWrapperLeft I NoWindow PackWindowLeft $[w.y] $[w.x] $[w.width] $[w.id] $[w.height]

DestroyFunc PackWindowRight
AddToFunc PackWindowRight
+ I SetEnv right_w $[vp.width]
+ I WindowId $3 Raise
+ I All (CurrentPage !Iconic AcceptsFocus \
        !Shaded) PipeRead "test $[w.x] -lt $[right_w] \
        -a $[w.x] -gt `expr $1 + $2` \
        -a \\( \\( $[w.y] -gt $0 -a $[w.y] -lt `expr $0 + $4` \\) \
            -o \\( $[w.y] -lt $0 -a `expr $[w.y] + $[w.height]` -gt $0 \\) \
            -o \\( $[w.y] -ge $0 -a `expr $[w.y] + $[w.height]` -le `expr $0 + $4` \\) \
            -o \\( $[w.y] -lt $0 -a `expr $[w.y] + $[w.height]` -gt `expr $0 + $4` \\) \
        \\) \
        && echo SetEnv right_w $[w.x] \
        || echo Nop"
+ I PipeRead "echo WindowId $3 AnimatedMove `expr $[right_w] - $2`p keep"
#+ I WindowId $3 RefreshWindow

AddToFunc PackWrapperRight I NoWindow PackWindowRight $[w.y] $[w.x] $[w.width] $[w.id] $[w.height]

#####
# Name:     WheelToggleShade
# Bound:    Mouse Buttons 4 and 5 (wheel up and down) on Titlebars
# Purpose:  Shade or unshade the window when the Mouse wheel is rolled up or
#           down on the Titlebar. Rolling the Wheel up calls the Function with
#           argument `True` and rolling it down uses `False`, so rolling the wheel
#           down when the window isnt shaded has no effect, which I like :)
#
# -taviso
#################
DestroyFunc WheelToggleShade
AddToFunc WheelToggleShade D WindowShade $0

#####
# Name:     DestroyOnHold
# Bound:    Titlebar Button 2 (X)
# Purpose:  When clicked, Raise the window Immediately.
#           If the button is pressed and released, Close the Window. If it is pressed
#           and held, Destroy it, and issue a Beep to confirm.
#
#           There is a 100ms delay before issuing `Close` so I have a chance to see the
#           animation when the button changes from ActiveDown to ActiveUp :).
#
# -taviso
#################
DestroyFunc DestroyOnHold
AddToFunc DestroyOnHold I Raise
+ C Schedule 100 Close
+ H Destroy
+ H Beep

#####
# Name:     Thumbnail
# Purpose:  Iconify a window with a reduced screenshot of the application
#           Window, looks really cool.
#
#           Uses FvwmEvent to remove the Icon when deiconified, you will want
#           to remove this if you use WindowStyle elsewhere.
#
#           Thumbnailing example: [6]http://dev.gentoo.org/~taviso/step2.png
#
# -taviso
##################
DestroyFunc Thumbnail
AddToFunc Thumbnail
+ I Raise
+ I PipeRead "xwd -silent -id $[w.id] | convert -scale $[fvwm_icon_size] -frame 1x1 \
    -mattecolor black -quality 0 xwd:- png:$[HOME]/.fvwm/icon.tmp.$[w.id].png \
    && echo WindowStyle IconOverride, Icon $[HOME]/.fvwm/icon.tmp.$[w.id].png, StaysOnTop \
    || echo Nop"
+ I Iconify

DestroyFunc DeThumbnail
AddToFunc DeThumbnail
+ I DestroyWindowStyle
+ I Exec exec rm -f $HOME/.fvwm/icon.tmp.$[w.id].png

# FIXME: This will destroy all Windowstyle settings.
*FvwmEvent: deiconify DeThumbnail

# FIXME: Make this more useful.
# XXX: This doesnt do much yet, you can play with it if you like.
# Example: [7]http://dev.gentoo.org/~taviso/fvwm_expose.png
DestroyFunc FvwmExpose
AddToFunc FvwmExpose
+ I AddToMenu FvwmExposeMenu ".: e x p o s e :." Title
+ I All (!Iconic !Shaded CurrentPage AcceptsFocus)\
    PipeRead "echo Raise; \
        xwd -silent -id $[w.id] | convert -scale 128 -frame 1x1 \
        -mattecolor white -quality 0 xwd:- \
        png:$[HOME]/.fvwm/icon.exp.$[w.id].png \
    && echo AddToMenu FvwmExposeMenu \
    %$[HOME]/.fvwm/icon.exp.$[w.id].png%\\\'\"$[w.name]\"\\\' WindowID $[w.id] WarpToWindow 50 50 \
        && echo AddToMenu FvwmExposeMenu \\\"\\\" Nop \
    || Nop"
+ I Popup FvwmExposeMenu
+ I DestroyMenu FvwmExposeMenu
+ I Exec exec rm -f $[HOME]/.fvwm/icon.exp.*

AddToFunc WindowListFunc I WarpToWindow 50 50

DestroyFunc FuncAutoEnter
AddToFunc FuncAutoEnter I Autohide HiddenConsole 250 500 N

####
# These functions modified from the functions provided in the fvwm FAQ.
# [8]http://www.fvwm.org/documentation/faq/#7.17
# 
# -taviso
#################
AddToFunc Autohide
+ I ThisWindow ($0) Deschedule $[w.id]
+ I TestRc (!Match) Deschedule -$[w.id]
+ I ThisWindow ($0) ThisWindow (shaded) AutohideShow $1 $3
+ I TestRc (!Match) All ($0, !shaded) AutohideHide $2 $3

AddToFunc AutohideShow
+ I Schedule $0 -$[w.id] WindowShade $1 off
+ I Schedule $0 -$[w.id] Raise
+ I Schedule $0 -$[w.id] Deschedule $[w.id]
+ I Schedule $0 -$[w.id] Deschedule -$[w.id]

AddToFunc AutohideHide
+ I Schedule $0 $[w.id] WindowShade $1 on
+ I Schedule $0 $[w.id] Deschedule $[w.id]
+ I Schedule $0 $[w.id] Deschedule -$[w.id]

#####
# Miscellaneous Functions
# 
# -taviso
#################
AddToFunc Move-or-Raise I Raise
+ M Move
+ D WindowShade Toggle

AddToFunc Maximize-Func M Maximize 0 100
+ C Maximize       0 80
+ D Maximize       100 100

AddToFunc Move-or-Iconify I Raise
+ M Move
+ D Iconify

AddToFunc Resize-or-Raise I Raise
+ M Resize
+ D Lower

#####
# FvwmPager is probably the most advanced desktop pager ever written,
# of course its highly configurable, has many advanced features, and can
# be made to look very eye candy.
#
# You can drag the Windows around inside the Pager, pull windows from
# other desktops out onto your current page, or drag the viewport into
# non-standard positions.
#
# This pager gets swallowed into my FvwmButtons Bar. The pages are seperated
# by solid white lines, the pager itself is tinted transparent and the colours
# lighten as focus and the viewport changes.
#
# You can write titles, or draw icons into the Windows, but i prefer to use
# the Balloons (tooltips) to find the Names.
#
#   +-----+-----+-----+
#   |     |     |     |
#   +-----+-----+-----+
#   |     |     |     |
#   +-----+-----+-----+
#   |     |     |     |
#   +-----+-----+-----+
#
# -taviso (original)
# -xiphux (transparent black version)
#################
Colorset 2 fg white, bg black, RootTransparent, Tint #b5b2ff 80
#Colorset 3 fg white, bg black, RootTransparent, Tint #eeefcf 70
Colorset 3 fg white, bg black, RootTransparent
Colorset 4 fg #63656e, bg black, RootTransparent, Tint #b5b2ff 60
Colorset 5 fg black, bg Khaki1, Plain
Colorset 6 fg white, bg black, RootTransparent, Tint #e4e5c7 90
DestroyModuleConfig FvwmPager: *
*FvwmPager: Colorset * 3
*FvwmPager: HilightColorset * 6
*FvwmPager: WindowColorsets 4 2
*FvwmPager: BalloonColorset * 5
*FvwmPager: Font none
*FvwmPager: SmallFont 5x8
*FvwmPager: Balloons All
*FvwmPager: BalloonFont "xft:mintsstrong"
*FvwmPager: BalloonYOffset +2
*FvwmPager: BalloonBorderWidth 1
*FvwmPager: UseSkipList
*FvwmPager: MoveThreshold 3
*FvwmPager: SolidSeparators
*FvwmPager: WindowLabelFormat ""
*FvwmPager: WindowBorderWidth 1

#Colorset 10 fg black, bg #c6c3c6, RootTransparent, Tint #efebef 65
Colorset 10 fg white, bg black, RootTransparent
DestroyModuleConfig FvwmButtons: *
*FvwmButtons: Columns 23
#*FvwmButtons: Font "Shadow=1 1 SE:xft:Bitstream Vera Sans Mono:style=Roman:size=10"
*FvwmButtons: Font "Shadow=1 1 SE:xft:mintsstrong"
#*FvwmButtons: Font "Shadow=1 1 SE:xft:snap"
*FvwmButtons: Colorset 10
*FvwmButtons: Frame 1
*FvwmButtons: Padding 2 2
*FvwmButtons: Rows 80
*FvwmButtons: (Size 1x80, Back #dedbde, Frame 1, Action (Mouse 1) `Nop`)
*FvwmButtons: (Title (Side) " mgt", Left, Back #dedbde, Icon scaled/multignometerm.png, \
    Size 22x2, Action (Mouse 1) `Exec exec multi-gnome-terminal`)
*FvwmButtons: (Title (Side) " rhythmbox", Left, Back #dedbde, Icon scaled/rhythmbox.png, \
    Size 22x2, Action (Mouse 1) `Exec exec schedtool -I -e rhythmbox`)
*FvwmButtons: (Title (Side) " firefox", Left, Back #dedbde, Icon scaled/firefox.png, \
    Size 22x2, Action (Mouse 1) `Exec exec firefox`)
*FvwmButtons: (Title (Side) " links", Left, Back #dedbde, Icon scaled/links.png, \
    Size 22x2, Action (Mouse 1) `Exec exec links2 -g -driver x`)
*FvwmButtons: (Size 22x1, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Title (Side) " gedit", Left, Back #dedbde, Icon scaled/gedit.png, \
    Size 22x2, Action (Mouse 1) `Exec exec gedit`)
*FvwmButtons: (Title (Side) " anjuta", Left, Back #dedbde, Icon scaled/anjuta.png, \
    Size 22x2, Action (Mouse 1) `Exec exec anjuta`)
*FvwmButtons: (Title (Side) " glade-2", Left, Back #dedbde, Icon scaled/glade-2.png, \
    Size 22x2, Action (Mouse 1) `Exec exec glade-2`)
*FvwmButtons: (Title (Side) " gossip", Left, Back #dedbde, Icon scaled/gossip.png, \
    Size 22x2, Action (Mouse 1) `Exec exec gossip`)
*FvwmButtons: (Title (Side) " abiword", Left, Back #dedbde, Icon scaled/abiword.png, \
    Size 22x2, Action (Mouse 1) `Exec exec abiword-2.0`)
*FvwmButtons: (Title (Side) " gnumeric", Left, Back #dedbde, Icon scaled/gnumeric.png, \
    Size 22x2, Action (Mouse 1) `Exec exec gnumeric`)
*FvwmButtons: (Title (Side) " gqview", Left, Back #dedbde, Icon scaled/gqview.png, \
    Size 22x2, Action (Mouse 1) `Exec exec gqview`)
*FvwmButtons: (Title (Side) " vmware", Left, Back #dedbde, Icon scaled/vmware.png, \
    Size 22x2, Action (Mouse 1) `Exec exec vmware`)
*FvwmButtons: (Size 22x1, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Title (Side) " calculator", Left, Back #dedbde, Icon scaled/gnome-calc.png, \
    Size 22x2, Action (Mouse 1) `Exec exec calcoo`)
*FvwmButtons: (Title (Side) " manual page", Left, Back #dedbde, Icon scaled/pan.png, \
    Size 22x2, Action (Mouse 1) `Exec exec xman`)
*FvwmButtons: (Title (Side) " magnifier", Left, Back #dedbde, Icon find.png, \
    Size 22x2, Action (Mouse 1) `Exec exec xmag`)
*FvwmButtons: (Title (Side) " run...", Left, Back #dedbde, Icon harddisk.png, \
    Size 22x2, Action (Mouse 1) `Exec exec grun`)
*FvwmButtons: (Size 22x1, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Title (Side) " configure", Left, Back #dedbde, Icon control-center.png, \
    Size 22x2, Action (Mouse 1) `Module FvwmScript FvwmScript-ScreenSetup`)
#*FvwmButtons: (Title (Side) " lock screen", Left, Back #dedbde, Icon key2.png, \
#    Size 22x2, Action (Mouse 1) `Exec exec xscreensaver-command --lock`)
*FvwmButtons: (Title (Side) " show desktop", Left, Back #dedbde, Icon desktop.png, \
    Size 22x2, Action (Mouse 1) `All (AcceptsFocus CurrentPage !Iconic !Shaded) Thumbnail`)
*FvwmButtons: (Title (Side) " sticky note", Left, Back #dedbde, Icon kate.png, \
    Size 22x2, Action (Mouse 1) `Exec exec xpad`)
*FvwmButtons: (Title (Side) " xkill", Left, Back #dedbde, Icon toxic.png, \
    Size 22x2, Action (Mouse 1) `Exec exec xkill`)
*FvwmButtons: (Size 22x1, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
#*FvwmButtons: (Title (Side) " Fvwm Console", Left, Back #dedbde, Icon hardware_monitor.png, \
#    Size 22x2, Action (Mouse 1) `Module FvwmConsole -terminal rxvt`)
*FvwmButtons: (Title (Side) " edit fvwm2rc", Left, Back #dedbde, Icon scaled/gtkvim.png, \
    Size 22x2, Action (Mouse 1) `Exec exec gvim -geom 115x46 ~/.fvwm/.fvwm2rc`)
*FvwmButtons: (Title (Side) " restart", Left, Back #dedbde, Icon hd.png, \
    Size 22x2, Action (Mouse 1) `Restart`)
*FvwmButtons: (Title (Side) " quit fvwm", Left, Back #dedbde, Icon shutdown.png, \
    Size 22x2, Action (Mouse 1) `Module FvwmScript FvwmScript-Quit`)
*FvwmButtons: (Size 22x2, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Size 10x6, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Size 12x6, Swallow wmcalc, 'Exec exec wmcalc -geometry -3000-3000')
*FvwmButtons: (Size 10x6, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Size 12x6, Swallow wmbio, 'Exec exec wmbio')
*FvwmButtons: (Size 22x2, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Size 22x8, Swallow "FvwmPager" "FvwmPager 0 0")
*FvwmButtons: (Size 22x1, Frame 0, Back #c6c3c6, Action (Mouse 1) `Nop`)
*FvwmButtons: (Size 22x2, Swallow peksystray, 'Exec exec peksystray')

Colorset 11 fg white, bg #c6c3c6, sh black, hi black, RootTransparent buffer
DestroyModuleConfig FvwmTaskBar: *
*FvwmTaskBar: Geometry +0-0
*FvwmTaskBar: Rows 1
*FvwmTaskBar: Font "xft:Bitstream Vera Sans Mono:style=Roman:size=10"
*FvwmTaskBar: StatusFont "xft:Bitstream Vera Sans Mono:style=Roman:size=10"
*FvwmTaskBar: SelFont "xft:Bitstream Vera Sans Mono:style=Roman:size=10"
*FvwmTaskBar: Colorset 11
*FvwmTaskBar: AutoStick
*FvwmTaskBar: UseSkipList
*FvwmTaskBar: PageOnly
*FvwmTaskBar: ShowTips
*FvwmTaskBar: NoDefaultStartButton
*FvwmTaskBar: NoBrightFocus
*FvwmTaskBar: 3DFvwm
*FvwmTaskBar: MailCheck 0
*FvwmTaskBar: IconColorset 11
*FvwmTaskBar: FocusColorset 11
*FvwmTaskBar: ClockFormat
*FvwmTaskBar: WindowButtonsRightMargin 124

# References
# 
#    1. http://dev.gentoo.org/~taviso/screenshots/
#    2. http://digitalblasphemy.com/
#    3. http://www.fvwm.org/documentation/faq/#5.5
#    4. http://dev.gentoo.org/~taviso/autohide_console.png
#    5. http://www.mail-archive.com/fvwm%40hpc.uh.edu/msg05260.html
#    6. http://dev.gentoo.org/~taviso/step2.png
#    7. http://dev.gentoo.org/~taviso/fvwm_expose.png
#    8. http://www.fvwm.org/documentation/faq/#7.17
# 
# -taviso
#
